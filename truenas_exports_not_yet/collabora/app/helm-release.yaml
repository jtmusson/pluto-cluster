metadata:
    name: collabora
    namespace: collabora
spec:
    interval: 15m
    chart:
        spec:
            chart: collabora
            version: 6.0.12
            sourceRef:
                kind: HelmRepository
                name: truecharts
                namespace: flux-system
    releaseName: collabora
    values:
        TZ: Europe/London
        addons:
            codeserver:
                enabled: false
            netshoot:
                enabled: false
            vpn:
                type: disabled
        collabora:
            dictionaries:
                - de_DE
                - en_GB
                - en_US
                - el_GR
                - es_ES
                - fr_FR
                - pt_BR
                - pt_PT
                - it
                - nl
                - ru
            extra_params:
                - --o:welcome.enable=false
            interface: default
            no_gen_ssl: true
            password: REPLACED
            server_name: collabora.musson-serv.uk
            ssl_enable: false
            ssl_termination: true
            username: admin
        ingress:
            main:
                enabled: true
                hosts:
                    - host: collabora.musson-serv.uk
                      paths:
                        - path: /
                          pathType: Prefix
                ingressClassName: ""
                integrations:
                    certManager:
                        certificateIssuer: cloudflare-prod
                        enabled: true
                    homepage:
                        enabled: false
                    traefik:
                        allowCors: false
                        enabled: true
                        entrypoints:
                            - websecure
        release_name: collabora
        resources:
            limits:
                cpu: 8000m
        securityContext:
            container:
                UMASK: "0022"
                runAsGroup: 568
                runAsUser: 568
            pod:
                fsGroupChangePolicy: OnRootMismatch
        service:
            main:
                enabled: true
                ports:
                    main:
                        port: 9980
                        protocol: http
                        targetPort: 9980
                type: ClusterIP
        workload:
            main:
                podSpec:
                    containers:
                        main:
                            envFrom:
                                - configMapRef:
                                    name: collabora-config
                            securityContext:
                                allowPrivilegeEscalation: true
                                capabilities:
                                    add:
                                        - CHOWN
                                        - FOWNER
                                        - SYS_CHROOT
                                        - MKNOD
                                readOnlyRootFilesystem: false
                                runAsGroup: 102
                                runAsUser: 100
                replicas: 1
                type: Deployment
